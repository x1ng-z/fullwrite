package hs.fullwrite.test;

import com.alibaba.fastjson.JSONObject;
import hs.fullwrite.dao.service.InfluxdbOperateService;
import hs.fullwrite.job.ThemorDataCollector;
import hs.fullwrite.longTimeServe.event.InfluxWriteEvent;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.sql.*;
import java.util.HashMap;
import java.util.Map;

/**
 * @author zzx
 * @version 1.0
 * @date 2021/2/2 11:27
 */
public class test_sqlserve {
    private Logger logger = LoggerFactory.getLogger(ThemorDataCollector.class);

    private static final String DRIVER = "com.microsoft.sqlserver.jdbc.SQLServerDriver";
    private static final String URL = "jdbc:sqlserver://192.168.99.247:1433;DatabaseName=Nautilus";
    //    private static final String DATABASE_NAME = "Nautilus";
    private static final String USER_NAME = "sa";
    private static final String PASSWORD = "Thermo!1";

    public static void main(String args[]) {



        String haha="{\"A410510T01\":14.517706871032715," +
                "\"A410510T02\":20.036630630493164," +
                "\"A410510T03\":27.80219841003418," +
                "\"A410510T04\":23.260074615478516," +
                "\"A41E1AH04I\":0," +
                "\"A41E1AH05I\":0," +
                "\"A41E2AH07I\":0," +
                "\"A51C11AP01\":0," +
                "\"A51C11BP01\":0," +
                "\"A51C12AP01\":0," +
                "\"A51C12BP01\":0," +
                "\"A5201CLJ\":6808650," +
                "\"A5201c1Z01\":0," +
                "\"A5201c2Z01\":0," +
                "\"A5601M1T1a\":18.4981689453125," +
                "\"A5601M1T2a\":21.575092315673828," +
                "\"A5601P1T1a\":0," +
                "\"A5601T01Ba\":21.868133544921875," +
                "\"A5601T02Aa\":34.102565765380859," +
                "\"A5601T02Ba\":24.24908447265625," +
                "\"A5601T03Aa\":29.890110015869141," +
                "\"A5601T03Ba\":25.164834976196289," +
                "\"ACCB41061\":22494.470703125,\"ACCUNB3513\":2299049.5," +
                "\"ACCUNB3515\":37421.4296875,\"ACCUNB3516\":245880.53125," +
                "\"ACCUNB3517\":276.60357666015625,\"ACCUNB5203\":5136075.5," +
                "\"ACCUNB7303\":248107.921875,\"ACCUNB7304\":0," +
                "\"ACCUNB7501\":141980.09375,\"ACCUNB7502\":94650.4140625," +
                "\"ACCUNR5204\":5375790.5,\"ACCUNY3513\":8672361," +
                "\"ACCUNY3515\":137872.734375,\"ACCUNY3516\":1415246," +
                "\"ACCUNY3517\":113449.8671875,\"ACCUNY5203\":6489487.5," +
                "\"ACCUNY5204\":5375790.5,\"ACCUNY7303\":1257356.5," +
                "\"ACCUNY7304\":0,\"ACCUNY7501\":750913.1875,\"ACCUNY7502\":457149.9375," +
                "\"ACCY41061\":113630.0234375,\"AI0201ARI\":54.065937042236328," +
                "\"AI0201ARS\":33.4920654296875,\"AI0202ARI\":37.948719024658203," +
                "\"AI0202MI\":28.327230453491211,\"AI0202T01a\":41.428573608398438," +
                "\"AI0202T01b\":45.897438049316406,\"AI0205aZ01\":0,\"AI0207MI\":33.74847412109375,\"AI12021I\":13.040292739868164,\"AI12021S\":50,\"AI12021T1\":82.967033386230469,\"AI1203MI\":146.12942504882813,\"AI1204I\":46.275947570800781,\"AI1ACZ\":307.9853515625,\"AI1ALL\":2.1040294170379639,\"AI1BCZ\":795.8974609375,\"AI1BLL\":6.4498171806335449,\"AI202MT01a\":22.527473449707031,\"AI202MT01b\":19.670330047607422,\"AI202MT02a\":36.00732421875,\"AI202MT02b\":87.4725341796875,\"AI202MT02c\":73.626373291015625,\"AI2204I\":0,\"AI2205I\":0.09768010675907135,\"AI2205MI\":105.44567108154297,\"AI2301I\":30.74481201171875,\"AI2303I\":0,\"AI2304I\":0.024420026689767838,\"AI2ACZ\":529.67034912109375,\"AI2ALL\":6.4439563751220703,\"AI2BCZ\":600,\"AI2BLL\":9.9692306518554688,\"AI3500L01\":1.4432234764099121,\"AI3500L03\":6.229548454284668,\"AI3500L05\":4.4175825119018555,\"AI3500L07\":0,\"AI3513AR\":0,\"AI3514ARI\":0.061538461595773697,\"AI3514ARS\":0,\"AI3514bI\":0,\"AI3514bS\":0.048840053379535675,\"AI3515AR\":0.0036630039103329182,\"AI3516AR\":0.048840053379535675,\"AI3516bL\":0,\"AI3517AR\":0.043956045061349869,\"AI3519I\":0.024420026689767838,\"AI3520S\":0,\"AI3529MSD\":0,\"AI3530ML\":0.029304031282663345,\"AI3532MSD\":0.43956047296524048,\"AI3533ML\":0.0097680101171135902,\"AI4105101I\":1.0805860757827759,\"AI4105101S\":0,\"AI41054L\":255.82418823242188,\"AI41054P\":51.770454406738281,\"AI41056P01\":42.24664306640625,\"AI41059\":7.3260073661804199,\"AI41059F01\":0,\"AI41059Z01\":100,\"AI4105MT01\":27.948719024658203,\"AI4105MT02\":19.450550079345703,\"AI4105P01\":-280.34185791015625,\"AI4105P02\":-271.062255859375,\"AI4105P03\":-170.94015502929688,\"AI4105P04\":-278.38827514648438,\"AI4105P05\":107.421875,\"AI4105PT01\":20.219781875610352,\"AI4105PT02\":42.600734710693359,\"AI4105PT03\":39.157512664794922,\"AI4105T01\":17.460317611694336,\"AI4105T02\":19.633701324462891,\"AI4105V01\":0.039072040468454361,\"AI41061\":0,\"AI41061L\":3.8388280868530273,\"AI41062L\":0,\"AI4108I\":0,\"AI4111P01\":0,\"AI4111P02\":-275.45785522460938,\"AI4111P03\":-304.76190185546875,\"AI4111P04\":-319.41390991210938,\"AI4111T01\":20.659341812133789,\"AI411BFP01\":-52.747249603271484,\"AI411BFP02\":-100.12209320068359,\"AI411BFT01\":30.622711181640625,\"AI411BFT02\":17.728937149047852,\"AI411BV01F\":0,\"AI411BV02F\":0.36630037426948547,\"AI411BV03F\":0,\"AI411BV04F\":1.245421290397644,\"AI411BV05F\":99.682540893554688,\"AI411BV06F\":0.12210012972354889,\"AI411CNP01\":-315.75088500976563,\"AI411CNT01\":41.025642395019531,\"AI411FN01I\":0,\"AI411FN02I\":0.24420025944709778,\"AI411FN1SD\":0,\"AI411FN2SD\":0.7032967209815979,\"AI411FN2T2\":13.479853630065918,\"AI411FNP01\":0,\"AI411FP1P1\":1.7094017267227173,\"AI411FP1P2\":0,\"AI411FW02F\":0,\"AI411SS01F\":0.44078144431114197,\"AI4122MT01\":22.783884048461914,\"AI4122MT02\":16.336996078491211,\"AI4122MT2\":15.421245574951172,\"AI4122T01\":17.582418441772461,\"AI4122T02\":14.761904716491699,\"AI4122aZ01\":0,\"AI4123Z01\":0.21978023648262024,\"AI4124P01\":0,\"AI4124Z01\":0.024420026689767838,\"AI4125Z01\":0,\"AI4126Z01\":1.4652014970779419,\"AI4160MI\":1.273992657661438,\"AI4160ML\":378.02197265625,\"AI4160MP\":1.6703296899795532,\"AI42011I\":79.73138427734375,\"AI4207Z01\":0,\"AI4208L01\":28.205127716064453,\"AI4209cZ01\":0,\"AI4210cZ01\":4.1269841194152832,\"AI4211I\":0,\"AI4211P01\":0,\"AI4212I\":0,\"AI4213P01\":0,\"AI5101ANO\":0,\"AI5101AP02\":0,\"AI5101BP02\":0,\"AI5101BP05\":0,\"AI5101P01\":-49.084247589111328,\"AI5101P02\":0,\"AI5101P03\":-543.101318359375,\"AI5101P04\":-2000,\"AI5101T01\":429.30404663085938,\"AI5101T01B\":468.937744140625,\"AI5101T02\":237.4603271484375,\"AI5101T02B\":243.29670715332031,\"AI5101T03\":322.5396728515625,\"AI5101T04\":0,\"AI5101T05\":391.11111450195313,\"AI5101T06\":0,\"AI5102Z01\":99.975578308105469,\"AI5102Z02\":0.024420026689767838,\"AI5106Z01\":0,\"AI51C1AP01\":0,\"AI51C1AT01\":211.23321533203125," +
                "\"AI51C1AT02\":212.21002197265625,\"AI51C1BP01\":-5236.6298828125,\"AI51C1BT01\":210.01220703125,\"AI51C1BT02\":220.80586242675781,\"AI51C1P01\":0,\"AI51C1T01\":166.05616760253906,\"AI51C2AP01\":0,\"AI51C2AP02\":0,\"AI51C2AT01\":253.96826171875,\"AI51C2BP01\":0,\"AI51C2BP02\":0,\"AI51C2BT01\":255.921875,\"AI51C3AP01\":0,\"AI51C3AP02\":0,\"AI51C3AT01\":269.35287475585938,\"AI51C3BP01\":0,\"AI51C3BP02\":0,\"AI51C3BT01\":271.79489135742188,\"AI51C4AP01\":0,\"AI51C4AP02\":0,\"AI51C4AT01\":292.52749633789063,\"AI51C4AT02\":230.20756530761719,\"AI51C4BP01\":0,\"AI51C4BP02\":0,\"AI51C4BT01\":283.931640625,\"AI51C4BT02\":233.43101501464844,\"AI51C5\":387.890625,\"AI51C5AP01\":0,\"AI51C5AP02\":0,\"AI51C5AP03\":0,\"AI51C5AT01\":302.71063232421875,\"AI51C5AT02\":333.18682861328125,\"AI51C5AT03\":880,\"AI51C5BP01\":0,\"AI51C5BP02\":0,\"AI51C5BP03\":0,\"AI51C5BT01\":299.4871826171875,\"AI51C5BT02\":387.9853515625,\"AI51C5BT03\":880,\"AI5201CF\":110,\"AI5201CI\":0.75692307949066162,\"AI5201CL\":0,\"AI5201CP\":1.6703296899795532,\"AI5201CS\":0,\"AI5201aW01\":148.16850280761719,\"AI5203F01\":0,\"AI5206P01\":15.433455467224121,\"AI521011I\":0.5128205418586731,\"AI521012I\":0.43956044316291809,\"AI5213Z01\":58.168498992919922,\"AI54011Z01\":0,\"AI54015I\":0,\"AI54015S2\":0,\"AI5401MT01\":12.014652252197266,\"AI5401MT02\":20.366300582885742,\"AI5401P01\":-288.15628051757813,\"AI5401T01\":20.622711181640625,\"AI5401T02\":20.109891891479492,\"AI5401T3\":21.428571701049805,\"AI5401V01\":2.4371185302734375,\"AI5402P01\":-170.94015502929688,\"AI5402T01\":104.24908447265625,\"AI5402T02\":114.04151153564453,\"AI5402T03\":106.73992919921875,\"AI5404P01\":-194.87178039550781,\"AI5404P02\":-216.84980773925781,\"AI5404T01\":94.945060729980469,\"AI5404T02\":83.516487121582031,\"AI54103I\":30.207571029663086,\"AI54103S2\":215.79145812988281,\"AI5410MT01\":26.556777954101563,\"AI5410MT02\":19.926740646362305,\"AI5410T01\":21.172163009643555,\"AI5410T1\":14.54212474822998,\"AI5410T2\":21.391942977905273,\"AI5410aZ01\":0,\"AI5411Z01\":95.824172973632813,\"AI5412Z01\":0.09768010675907135,\"AI5413Z01\":97.338218688964844,\"AI5414Z01\":0,\"AI54SL01\":4.4000000953674316,\"AI54SZ01\":87.545791625976563,\"AI54SZ02\":0,\"AI56011I\":0,\"AI56011S\":0,\"AI56012I\":0.46398049592971802,\"AI5601T01A\":36.666667938232422,\"AI5610aZ01\":0,\"AI5701P01\":-46.739917755126953,\"AI5701T01\":76.5079345703125,\"AI5701T01B\":176.77656555175781,\"AI5702BTH\":11.111111640930176,\"AI5702MI1\":0,\"AI5702MI2\":0,\"AI5702MI3\":0,\"AI5702MI4\":0,\"AI5702MI5\":0,\"AI5702MI6\":0,\"AI5702MI7\":0,\"AI5702MI8\":0,\"AI5702MI9\":0,\"AI5702T01\":19.780220031738281,\"AI5702T02\":29.914529800415039,\"AI5702T03\":35.286937713623047,\"AI5702T04\":29.181928634643555,\"AI5702T05\":38.583641052246094,\"AI5702T06\":34.065937042236328,\"AI5703MT11\":16.043956756591797,\"AI5703MT12\":12.857143402099609,\"AI5703MT21\":15.970696449279785,\"AI5703MT22\":13.882783889770508,\"AI5703MT31\":15.494505882263184,\"AI5703MT32\":14.358974456787109,\"AI5703MT41\":14.175824165344238,\"AI5703MT42\":13.882783889770508,\"AI5705MI\":102.05128479003906,\"AI5705Z\":10.134310722351074,\"AI5706MI\":77.216117858886719,\"AI5706Z\":10.940171241760254,\"AI5707MRI\":0,\"AI5707Z\":0,\"AI5708MRI\":0,\"AI5708Z\":0,\"AI5709MI\":0,\"AI5709MT03\":16.959707260131836,\"AI5709MT04\":15.34798526763916,\"AI5709MT05\":18.534797668457031,\"AI5709MT06\":19.597070693969727,\"AI5709MT07\":19.484004974365234,\"AI5709MT08\":19.30402946472168,\"AI5709MT09\":18.827840805053711,\"AI5709MT1\":15.421245574951172,\"AI5709MT10\":19.340660095214844,\"AI5709MT2\":15.128205299377441,\"AI5709Z\":0.024420026689767838,\"AI5710MBI\":2.1880342960357666,\"AI5710MBS\":5.8608059883117676,\"AI5711MBI\":2.3247864246368408,\"AI5711MBS\":5.1282052993774414,\"AI5712MBI\":1.1428571939468384,\"AI5712MBS\":0,\"AI5713MBI\":0,\"AI5713MBS\":0,\"AI5714MBI\":2.41269850730896,\"AI5714MBS\":0,\"AI5715MBI\":0,\"AI5715MBS\":0,\"AI5720P01\":1507.9378662109375,\"AI5720P02\":1507.9378662109375,\"AI5720P03\":12.210607528686523,\"AI5720P04\":7.3266029357910156,\"AI5720P05\":2.4425983428955078,\"AI5720P06\":-7.3260068893432617,\"AI5720P07\":2.4425983428955078,\"AI5720P08\":7.3266029357910156,\"AI5720P09\":2.4425983428955078,\"AI5720P10\":2.4425983428955078,\"AI5720P11\":2.4425983428955078,\"AI57211I\":0,\"AI57211V\":1.196581244468689,\"AI57212I\":0,\"AI57212V\":1.1477411985397339,\"AI57213I\":0,\"AI57213V\":2.4664225578308105,\"AI57214I\":7.8144083023071289,\"AI57214V\":1.1477411985397339,\"AI5721P01\":-36.630035400390625,\"AI5721P02\":0,\"AI5721T01\":11.135531425476074,\"AI5721T02\":8.9010992050170898,\"AI5722BMI\":0.68717950582504272,\"AI5722MI\":0,\"AI5722RPM\":6.7404155731201172,\"AI5722T01\":17.875457763671875,\"AI5722T02\":11.391942024230957,\"AI5722T03\":15.494505882263184,\"AI5722T04\":12.271062850952148,\"AI5722T05\":16.703296661376953,\"AI5722aZ01\":0,\"AI5730Z01\":0,\"AI5735MBI\":181.80708312988281,\"AI5735MBS\":500.74728393554688,\"AI5735P01\":0,\"AI5735T01\":0,\"AI5736ARI\":0,\"AI5736ARS\":0,\"AI5736MBI\":0,\"AI5736MBS\":2.1978023052215576,\"AI5737MBI\":0,\"AI5737MBS\":0,\"AI5737P01\":0,\"AI5738MBI\":0,\"AI5738MBS\":0,\"AI5739P01\":27765.568359375,\"AI6501MI\":0,\"AI6600L01\":0,\"AI6600L02\":16.058609008789063,\"AI6602Z01\":0,\"AI6609I\":122.54946136474609,\"AI6660407\":0,\"AI6701LF\":2.6520147323608398,\"AI7103M\":0.073260076344013214,\"AI7104M\":0,\"AI7300A01\":111.01343536376953,\"AI7300L01\":261.53848266601563,\"AI7300L03\":0,\"AI7300L1\":95.335777282714844,\"AI7300L3\":42.368743896484375,\"AI7303F01\":40.365081787109375,\"AI7304F01\":0.043956045061349869,\"AI7306MI\":72.161170959472656,\"AI7306MT02\":28.717948913574219,\"AI7306P01\":-1175.091552734375,\"AI7306P02\":-2432.234375,\"AI7306T01\":204.55433654785156,\"AI7306T02\":40.781440734863281,\"AI7306T03\":38.717952728271484,\"AI7306T04\":34.358974456787109,\"AI7306X01\":0,\"AI7306aP01\":0,\"AI7306aT01\":0,\"AI7306bP01\":0,\"AI7306bT01\":0,\"AI7306cP01\":0,\"AI7306cT01\":0,\"AI7307ARI\":28.786325454711914,\"AI7307ARS\":1287.003662109375,\"AI7307T01\":36.666667938232422,\"AI7311A01\":104.85958862304688,\"AI7311P01\":-4447.86328125,\"AI7311P02\":-5636.1416015625,\"AI7311T01\":40.586082458496094,\"AI7311T02\":34.774116516113281,\"AI7311T03\":39.633701324462891,\"AI7311T04\":40.036632537841797,\"AI7311T05\":33.846153259277344,\"AI7311T06\":38.4981689453125,\"AI7311T07\":36.483516693115234,\"AI7311T08\":39.413921356201172,\"AI7313MI\":21.520147323608398,\"AI7313MT01\":19.450550079345703,\"AI7313MT02\":37.032966613769531,\"AI7313MT03\":32.124542236328125,\"AI7313MT1\":26.923076629638672,\"AI7313T01\":33.186813354492188,\"AI7313aZ01\":50.036632537841797,\"AI7321T01\":30.329669952392578,\"AI7321W01\":62.632480621337891,\"AI7322T01\":32.893772125244141,\"AI7322W01\":68.122100830078125,\"AI7326Z01\":0.56166058778762817,\"AI7326Z01A\":0,\"AI7327Z01A\":1.5628817081451416,\"AI7406MT01\":26.886447906494141,\"AI7406MT02\":49.120880126953125,\"AI7501F01\":0,\"AI7502F01\":3.9594628810882568,\"AI7503M\":0,\"AI7503P01\":136.75213623046875,\"AI7504\":0,\"AI7504M\":0.90354090929031372,\"AI7505\":840.4395751953125,\"AI7505M\":106.79365539550781,\"AI7505P01\":21489.623046875,\"AI9201MI\":0,\"AI9201MT\":37.875461578369141,\"AI9201SPF\":0.36630037426948547,\"AI9202MI\":0,\"AI9202MT\":24.358974456787109,\"AI9202SPF\":2.1978023052215576,\"AI9203MI\":0,\"AI9203SPF\":0.36630037426948547,\"AI9203T\":25.347986221313477,\"AI9204T\":20.622711181640625,\"AI9205T\":0,\"AI9206MI\":55.968257904052734,\"AI9206MT\":0,\"AI9206SPF\":1297.4359130859375,\"AI9207MI\":69.034187316894531,\"AI9207MT\":0,\"AI9207SPF\":1396.3370361328125,\"AI9208MI\":97.328941345214844,\"AI9208SPF\":1496.3370361328125,\"AIBYQP\":3890.11083984375,\"AIBYQQ\":1104.2757568359375,\"AIC02LL\":0,\"AIC13AP01\":0,\"AIC13AP02\":0,\"AIC13AT01\":195.82417297363281,\"AIC13AT02\":206.03175354003906,\"AIC13BP01\":0,\"AIC13BP02\":0,\"AIC13BT01\":198.5103759765625,\"AIC13BT02\":186.69108581542969,\"AIJ02LL\":0,\"AIK01I\":0,\"AIK02I\":0,\"AIKSDLSS\":36.410255432128906,\"AIKSDLST\":19.120880126953125,\"AIMMDLSS\":27.521368026733398,\"AIMMDLST\":17.326007843017578,\"AIMTDLSS\":57.606842041015625,\"AIMTDLST\":20.329671859741211,\"AIMTSB1MI\":0,\"AIMTSB1MP\":0,\"AIMTSB2MI\":0,\"AIMTSB3MI\":0,\"AIMWCO\":3.7851037979125977,\"AISCICO\":0,\"AISCOCO\":0,\"AISLDYS\":42.124542236328125,\"AISLDYT\":20.659341812133789,\"AISZDLSS\":56.019538879394531,\"AISZDLST\":16.190475463867188,\"AIYLTPS\":53.528697967529297,\"AIYLTPT\":20.109891891479492,\"AIYT1BT\":27.985347747802734,\"AIYT2BT\":38.388278961181641,\"AIYTCCO\":0,\"AIYTDLSS\":35.384616851806641,\"AIYTDLST\":19.853481292724609,\"AIYTGYBPS\":40.879119873046875,\"AIYTGYBPT\":17.326007843017578,\"AIYTGYS\":70.866912841796875,\"AIYTGYT\":19.450550079345703,\"AIYWCCO\":0.48840051889419556,\"AIZYL4S\":51.111114501953125,\"AIZYL4T\":15.860806465148926,\"AP7306P01\":-1244.62890625,\"AP7311P01\":-1198.486328125,\"AS0201ARS\":33,\"AS0201ARSB\":0,\"AS0205aZ01\":0,\"AS12021S\":46,\"AS3514ARS\":5,\"AS3514b\":0,\"AS3529MSD\":8,\"AS3530ML\":12,\"AS3532MSD\":3,\"AS3533ML\":12,\"AS4105101S\":200,\"AS41054P\":100,\"AS41059\":1000,\"AS411BV01G\":100,\"AS411BV02G\":0,\"AS411BV03G\":0,\"AS411BV04G\":100,\"AS411BV05G\":100,\"AS411BV06G\":0,\"AS411FN1SD\":30,\"AS411FN2SD\":200,\"AS411FW02G\":0,\"AS411SS01G\":0.80000001192092896,\"AS4122aZ01\":0,\"AS4123Z01\":0,\"AS4124Z01\":0,\"AS4125Z01\":0,\"AS4126Z01\":0,\"AS4207Z01\":0,\"AS4209dZ01\":0,\"AS4210dZ01\":0,\"AS5101T01\":880,\"AS5102Z01\":100,\"AS5102Z02\":0,\"AS5106Z01\":100,\"AS5201CL\":100,\"AS5201CLF\":0,\"AS5201aW01\":105,\"AS5201c1Z1\":0,\"AS5201c2Z1\":0,\"AS5203F01\":0,\"AS5213Z01\":57,\"AS54011Z01\":100,\"AS54015S\":200,\"AS54103S\":220,\"AS5410aZ01\":99,\"AS5411Z01\":100,\"AS5412Z01\":0,\"AS5413Z01\":99,\"AS5414Z01\":0,\"AS54SZ01\":100,\"AS54SZ02\":100,\"AS56010002\":2.869999885559082,\"AS56010003\":0,\"AS56011S\":0.60000002384185791,\"AS5610aZ01\":44,\"AS5701P01\":-75,\"AS5705Z\":10,\"AS5706Z\":10,\"AS5707Z\":0,\"AS5708Z\":0,\"AS5709Z\":0,\"AS5710MBS\":333,\"AS5711MBS\":333,\"AS5712MBS\":333,\"AS5713MBS\":333,\"AS5714MBS\":333,\"AS5715MBS\":333,\"AS5722A\":420,\"AS5722RPM\":200,\"AS5722Z01\":99,\"AS5730Z01\":100,\"AS5735MBS\":500,\"AS5736MBS\":0,\"AS5737MBS\":0,\"AS5738MBS\":0,\"AS6602Z01\":100,\"AS7303F01\":40,\"AS7304F01\":0,\"AS7307ARS\":1280,\"AS7313aZ01\":52,\"AS7326Z01\":0,\"AS7326Z01A\":0,\"AS7327Z01\":0,\"AS7327Z01A\":0,\"AS7501A01\":22.5,\"AS7501F01\":0,\"AS7502F01\":4,\"AS7504ARS\":100,\"AS7505ARS\":840,\"AS9201\":1150,\"AS9202\":1250,\"AS9203\":1350,\"AS9206\":1300,\"AS9207\":1400,\"AS9208\":1500,\"A_BLJ_2PC\":1.2000000476837158,\"A_BLJ_AM\":0,\"A_BLJ_DB\":50,\"A_BLJ_HH\":5.5,\"A_BLJ_LL\":4.0500001907348633,\"A_BLJ_MV\":4.0100002288818359,\"A_BLJ_MV2\":4.8000001907348633,\"A_BLJ_SP\":8000,\"A_FJL_AM\":0,\"A_FJL_HH\":23.5,\"A_FJL_LL\":19.5,\"A_FJL_MV\":0,\"A_FJL_SP\":870,\"A_MMF_AM\":0,\"A_MMF_HH\":50,\"A_MMF_LL\":42,\"A_MMF_MV\":40,\"A_MMF_PV\":-173.017822265625,\"A_MMT_AM\":0,\"A_MMT_AM2\":0,\"A_MMT_HH\":80,\"A_MMT_HH2\":95,\"A_MMT_LL\":20,\"A_MMT_LL2\":80,\"A_MMT_MV\":0,\"A_MMT_MV2\":0,\"A_MMT_SP\":200,\"A_MMT_SP2\":59,\"A_SLM1_1SV\":0,\"A_SLM1_2SV\":100,\"A_SLM1_AM1\":0,\"A_SLM1_AM2\":0,\"A_SLM1_HI1\":465,\"A_SLM1_HI2\":740,\"A_SLM1_HSV\":2.25,\"A_SLM1_LHH\":0,\"A_SLM1_LLL\":0,\"A_SLM1_LO1\":455,\"A_SLM1_LO2\":720,\"A_SLM1_LSV\":2.25,\"A_SLM1_MV1\":400,\"A_SLM1_MV2\":1000,\"A_SLM1_PV4\":79.556892395019531,\"A_SLM1_SV1\":8065.93408203125,\"A_SLM1_SV2\":26,\"A_SLM1_SV3\":82,\"A_SLM1_SV4\":78,\"A_SLM1_SV5\":170,\"A_TXJY\":64.078147888183594,\"A_YTP_AM\":0,\"A_YTP_HH\":500,\"A_YTP_LL\":390,\"A_YTP_MV\":200,\"A_YTP_SP\":-100,\"C02LLLJ\":393908,\"C02LLLJB\":0,\"CMIM\":0,\"CMKH\":0,\"CMSM\":0,\"DSLFDL\":0,\"FCSJZS\":11.599103927612305,\"FSYGDBL_1\":19,\"FSYGDBL_2\":8,\"FSYPCBL\":75.951171875,\"FSYWLL\":76,\"HZGDBL_1\":1.5,\"HZPCBL\":30.000001907348633,\"HZWLL\":6,\"IW102\":4.0100002288818359,\"IW104\":4.8000001907348633,\"J02LLLJ\":198654,\"J02LLLJB\":0,\"JX001P\":3944.9990234375,\"KS001P\":292.49993896484375,\"KS002P\":187.49996948242188,\"KS003P\":0.49999994039535522,\"KS004P\":22,\"KS005P\":485.99993896484375,\"KSZGL\":679.9998779296875,\"LL411SS01L\":5144.4677734375,\"LL9201\":0,\"LLC04\":0,\"LLLJ9201\":0,\"LLLJC04\":0,\"MES_MF_HF\":25.569999694824219,\"MES_MF_SF\":2,\"MES_MF_XD\":7.5999999046325684,\"MES_RM_AD\":17.860000610351563,\"MES_RM_FC\":49.75,\"MES_RM_JZ\":4,\"MES_RM_MD\":1.4099999666213989,\"MES_RM_MR\":9,\"MES_RM_QN\":26241.169921875,\"MES_RM_VD\":30.979999542236328,\"MES_RS_AL\":3.559999942779541,\"MES_RS_CA\":43.720001220703125,\"MES_RS_FE\":2.4200000762939453,\"MES_RS_MG\":1.2300000190734863,\"MES_RS_SI\":14.159999847412109,\"MES_SL_FE\":2.440000057220459,\"MES_SL_KH\":0.89600002765655518,\"MES_SL_N\":2.4100000858306885,\"MES_SL_X2\":1.5,\"MES_SL_X8\":19.5,\"MES_ZY_FC\":0.62000000476837158,\"MES_ZY_KH\":0.89399999380111694,\"MES_ZY_LS\":1298,\"MES_ZY_N\":2.25,\"MGSGDBL_1\":0,\"MGSGDBL_2\":0,\"MGSPCBL\":0.2197265625,\"MGSWLL\":0,\"MMTSTX\":40.355224609375,\"MMZGL\":1352.9998779296875,\"MMZHDH\":33.527252197265625,\"MST_MF_HF\":20917,\"MST_MF_SF\":20917,\"MST_MF_XD\":20917,\"MST_RM_AD\":70713,\"MST_RM_FC\":70713,\"MST_RM_JZ\":70713,\"MST_RM_MD\":70713,\"MST_RM_MR\":70713,\"MST_RM_QN\":70713,\"MST_RM_VD\":70713,\"MST_RS_AL\":20918,\"MST_RS_CA\":20918,\"MST_RS_FE\":20918,\"MST_RS_MG\":20918,\"MST_RS_SI\":20918,\"MST_SL_FE\":20918,\"MST_SL_KH\":20918,\"MST_SL_N\":20918,\"MST_SL_X2\":20918,\"MST_SL_X8\":20918,\"MST_ZY_FC\":20918,\"MST_ZY_KH\":20917,\"MST_ZY_LS\":20917,\"MST_ZY_N\":20917,\"MT002P\":0,\"MTZGL\":302.99993896484375,\"N0211_CLLX\":10,\"N0211_CLSL\":0,\"N0211_TSSC\":4,\"N0211_TX1\":4.0537948608398438,\"N0211_TX2\":0,\"N0211_TXJY\":4.5999999046325684,\"N0211_WLL\":200,\"N0211_WLL2\":5.421205997467041,\"N0211_WLLB\":69.970703125,\"NOXSJZS\":365.13003540039063,\"PHCZKZ.PV\":148.16850280761719,\"QCSHOUR\":0,\"QCSMIN\":0,\"QCSTM\":0,\"QTZGL\":62,\"QW114\":547.16436767578125,\"QW116\":25.46296501159668,\"QW118\":0,\"QW120\":0,\"QW122\":940.1619873046875,\"QW124\":0,\"QW126\":0.23148147761821747,\"QW128\":0.11574073880910873,\"QW130\":0,\"QW132\":45.370368957519531,\"QW134\":46.990741729736328,\"QW136\":30.324073791503906,\"QW138\":41.898147583007813,\"QW140\":65.509262084960938,\"QW142\":54.861110687255859,\"QW144\":51.15740966796875,\"QW146\":40.509258270263672,\"QW148\":43.055553436279297,\"QW150\":35.416664123535156,\"QW152\":66.435188293457031,\"QW154\":55.208332061767578,\"QW156\":64.120368957519531,\"QW158\":948.0323486328125,\"QW160\":0,\"QW162\":0.11574073880910873,\"QW164\":243.28703308105469,\"QW166\":243.75,\"QW168\":284.14352416992188,\"QW170\":287.61575317382813,\"QW172\":299.1898193359375,\"QW174\":288.77316284179688,\"QW176\":282.52316284179688,\"QW178\":292.9398193359375,\"QW180\":282.98611450195313,\"QW182\":270.71759033203125,\"QW184\":300.34722900390625,\"QW186\":294.67593383789063,\"QW188\":297.6851806640625,\"QW24\":-0.007595486007630825,\"QW26\":-0.043041087687015533,\"QW28\":-0.020254630595445633,\"QW30\":-0.10886863619089127,\"SCTSTX\":0,\"SCZGL\":606.7498779296875,\"SCZHDH\":2,\"SHSGDBL_1\":78,\"SHSGDBL_2\":79.631752014160156,\"SHSPCBL\":62.400001525878906,\"SHSWLL\":312,\"SJCMAL2O3\":0,\"SJCMCaO\":0,\"SJCMFe2O3\":0,\"SJCMIM\":0,\"SJCMKH\":0,\"SJCMMgO\":0,\"SJCMSM\":0,\"SJCMSiO2\":0,\"SJRYIM\":0,\"SJRYKH\":0,\"SJRYSM\":0,\"SJSLAL2O3\":5.4000000953674316,\"SJSLCaO\":65.610000610351563,\"SJSLFeO3\":3.4600000381469727,\"SJSLIM\":1.559999942779541,\"SJSLKH\":0.90799999237060547,\"SJSLMgO\":1.5399999618530273,\"SJSLSM\":2.4700000286102295,\"SJSLSiO2\":21.840000152587891,\"SLGYBPS\":43.150184631347656,\"SLGYBPT\":21.904762268066406,\"SLGYS\":43.833942413330078,\"SLGYT\":21.611722946166992,\"SLTSTX\":0.096435546875,\"SLZGL\":311.49993896484375,\"SLZHDH\":0,\"SO2SJZS\":334.03369140625,\"SQZGL\":96.499984741210938,\"SSMFXH\":inf,\"SSSLCL\":0,\"STA41E1AH4\":0,\"STA505\":0,\"STA7501F\":1,\"SYBGDBL_1\":19,\"SYBGDBL_2\":9.4368600845336914,\"SYBPCBL\":50.666664123535156,\"SYBWLL\":76,\"SYPSZGL\":113,\"SYXIADLWa\":0,\"SYXIADLWaH\":0,\"SYXIADLWaL\":0,\"SYXIADLWb\":0,\"SYXIADLWbH\":0,\"SYXIADLWbL\":0,\"TP001P\":44,\"TP002P\":0,\"TP003P\":3,\"TP004P\":66,\"TSFK\":0.096435546875,\"TSSD\":400,\"TZGDBL_1\":1.5,\"TZGDBL_2\":1.4313880205154419,\"TZPCBL\":39.9755859375,\"TZWLL\":6,\"YJDTCL\":0,\"YL002P\":152.99996948242188,\"YL003H\":0,\"YL003P\":255.74996948242188,\"YL004H\":0,\"YL004P\":0,\"YL005H\":0,\"YL005P\":0,\"YL006P\":3488.99951171875,\"YL009H\":0,\"YL009P\":0,\"YL010H\":0,\"YL010P\":31.499996185302734,\"YL011H\":0,\"YL011P\":0.74999988079071045,\"YL012H\":0,\"YL012P\":449.99993896484375,\"YL013H\":0,\"YL013P\":152.24998474121094,\"YL014P\":-680.99993896484375,\"YT001P\":1809.999755859375,\"YT002H\":24.309116363525391,\"YT002P\":980.9998779296875,\"YT003H\":7.1366214752197266,\"YT003P\":287.99996948242188,\"YT004H\":0,\"YT004P\":0,\"YT005P\":136.49998474121094,\"YT006P\":247.49996948242188,\"YT007P\":136.49998474121094,\"YT008H\":0,\"YT008P\":0,\"YT009H\":0.89207780361175537,\"YT009P\":36,\"YT010P\":0,\"YT011P\":0,\"YT012P\":48,\"YT013P\":138,\"YT014P\":0,\"YT020P\":23,\"YT022P\":17,\"YTIME_D\":0,\"YTIME_F\":0,\"YTIME_H\":0,\"YTIME_M\":11,\"YTIME_R\":5,\"YTKLW\":12.698413848876953,\"YTKLWSJ\":12.713260650634766," +
                "\"YW001P\":4.1510238413960901e-38," +
                "\"YW002P\":2.7624892106322589e-36," +
                "\"YW003P\":0," +
                "\"YW004P\":1.7632547993324853e-36," +
                "\"YW005P\":2.0718487023045457e-37,\"YW006P\":22,\"YW007P\":0,\"YW008P\":-40,\"YW009P\":64,\"YW011P\":290.99996948242188,\"YWDLSS\":60.561664581298828,\"YWDLST\":22.74725341796875,\"ZHDH\":0,\"ZJGLYS\":1.0694587230682373,\"ZLLLJ9201\":674138.1875,\"ZLLLJC04\":70026.546875,\"ZXJCASLL\":0.23956045508384705,\"ZXJCASSJ\":0.00041595459333620965,\"ZXJCFC\":1.4774115085601807,\"ZXJCFCKZ\":20,\"ZXJCFCSJ\":1.712705135345459,\"ZXJCFCZS\":3.3213357925415039,\"ZXJCNOX\":228.52870178222656,\"ZXJCNOXKZ\":320,\"ZXJCNOXSJ\":139.56913757324219,\"ZXJCNOXZS\":514.31298828125,\"ZXJCO2\":15.927961349487305,\"ZXJCO2SJ\":17.582113265991211,\"ZXJCSO2\":244.30476379394531,\"ZXJCSO2KZ\":200,\"ZXJCSO2SJ\":149.22627258300781,\"ZXJCSO2ZS\":549.216064453125," +
                "\"function\":\"read\"," +
                "\"msg\":\"success\"," +
                "\"opcserveid\":1}";
        String replacehaha=haha.replace(":nan,",":0,").replace(":inf,",":"+Double.MAX_VALUE+",").replace(":-inf,",":"+Double.MIN_VALUE+",");

        System.out.println(replacehaha.substring(19383));
        JSONObject jj =JSONObject.parseObject(replacehaha);
        System.out.println(jj.getDouble("DSLFDL"));
        ResultSet rs = null;
        Statement stmt = null;
        Connection conn = null;
        ResultSetMetaData data = null;
        try {

            Map<String, String> k_column_v_class = new HashMap<>();
            Class.forName(DRIVER);
            conn = DriverManager.getConnection(URL, USER_NAME, PASSWORD);
            //新建一个查询
            stmt = conn.createStatement();
            //执行查询-->>返回一个结果集
            rs = stmt.executeQuery("select TOP 1 * from CementAnalysis order by DateEnd DESC ");    //括号里可以写相关的SQL语句，并把查询到的所有，放到一个rs集合里


//            ResultSetMetaData rss = rs.getMetaData();
            data = rs.getMetaData();
            for (int i = 1; i <= data.getColumnCount(); i++) {

                // 获得所有列的数目及实际列数
                int columnCount = data.getColumnCount();
// 获得指定列的列名
                String columnName = data.getColumnName(i);
// 获得指定列的列值
                int columnType = data.getColumnType(i);
// 获得指定列的数据类型名
                String columnTypeName = data.getColumnTypeName(i);
// 所在的Catalog名字
                String catalogName = data.getCatalogName(i);
// 对应数据类型的类
                String columnClassName = data.getColumnClassName(i);
// 在数据库中类型的最大字符个数
                int columnDisplaySize = data.getColumnDisplaySize(i);
// 默认的列的标题
                String columnLabel = data.getColumnLabel(i);
// 获得列的模式
                String schemaName = data.getSchemaName(i);
// 某列类型的精确度(类型的长度)
                int precision = data.getPrecision(i);
// 小数点后的位数
                int scale = data.getScale(i);
// 获取某列对应的表名
                String tableName = data.getTableName(i);
// 是否自动递增
                boolean isAutoInctement = data.isAutoIncrement(i);
// 在数据库中是否为货币型
                boolean isCurrency = data.isCurrency(i);
// 是否为空
                int isNullable = data.isNullable(i);
// 是否为只读
                boolean isReadOnly = data.isReadOnly(i);
// 能否出现在where中
                boolean isSearchable = data.isSearchable(i);
                System.out.println(columnCount);
                System.out.println("获得列" + i + "的字段名称:" + columnName);
                System.out.println("获得列" + i + "的类型,返回SqlType中的编号:" + columnType);
                System.out.println("获得列" + i + "的数据类型名:" + columnTypeName);
                System.out.println("获得列" + i + "所在的Catalog名字:" + catalogName);
                System.out.println("获得列" + i + "对应数据类型的类:" + columnClassName);
                System.out.println("获得列" + i + "在数据库中类型的最大字符个数:" + columnDisplaySize);
                System.out.println("获得列" + i + "的默认的列的标题:" + columnLabel);
                System.out.println("获得列" + i + "的模式:" + schemaName);
                System.out.println("获得列" + i + "类型的精确度(类型的长度):" + precision);
                System.out.println("获得列" + i + "小数点后的位数:" + scale);
                System.out.println("获得列" + i + "对应的表名:" + tableName);
                System.out.println("获得列" + i + "是否自动递增:" + isAutoInctement);
                System.out.println("获得列" + i + "在数据库中是否为货币型:" + isCurrency);
                System.out.println("获得列" + i + "是否为空:" + isNullable);
                System.out.println("获得列" + i + "是否为只读:" + isReadOnly);
                System.out.println("获得列" + i + "能否出现在where中:" + isSearchable);

                k_column_v_class.put(columnName, columnClassName);
            }

            while (rs.next()) {//rs.next()返回的是一个boolean值，这是一个指针，表示查询表头部的的下一条数据，加载第二次就是头部的下一条的下一条，以此类推//如果所需要查询的那一条有数据，就会返回true,没有就返回false


                for (Map.Entry<String, String> entry : k_column_v_class.entrySet()) {
                    String columname = entry.getKey();
                    String classname = entry.getValue();

                    Object value = rs.getObject(columname);
                    System.out.println(value.getClass());
//                    Constructor con=Class.forName(classname).getConstructor(Double.class);
//                    con.newInstance(rs.getObject(columname));
//                    System.out.println(o.toString());
                }
                JSONObject writecontext = new JSONObject();

                float Tons = rs.getFloat("Tons");
                writecontext.put("CementAnalysis_Tons", Tons);

                float Tph = rs.getFloat("Tph");
                writecontext.put("CementAnalysis_Tph", Tph);

                float Kgpm = rs.getFloat("Kgpm");
                writecontext.put("CementAnalysis_Kgpm", Kgpm);

                float SiO2 = rs.getFloat("SiO2");
                writecontext.put("CementAnalysis_SiO2", SiO2);

                float Al2O3 = rs.getFloat("Al2O3");
                writecontext.put("CementAnalysis_Al2O3", Al2O3);

                float Fe2O3 = rs.getFloat("Fe2O3");
                writecontext.put("CementAnalysis_Fe2O3", Fe2O3);

                float CaO = rs.getFloat("CaO");
                writecontext.put("CementAnalysis_CaO", CaO);

                float K2O = rs.getFloat("K2O");
                writecontext.put("CementAnalysis_K2O", K2O);

                float SO3 = rs.getFloat("SO3");
                writecontext.put("CementAnalysis_SO3", SO3);

                float MgO = rs.getFloat("MgO");
                writecontext.put("CementAnalysis_MgO", MgO);

                float Na2O = rs.getFloat("Na2O");
                writecontext.put("CementAnalysis_Na2O", Na2O);


                float Mn2O3 = rs.getFloat("Mn2O3");
                writecontext.put("CementAnalysis_Mn2O3", Mn2O3);

                float TiO2 = rs.getFloat("TiO2");
                writecontext.put("CementAnalysis_TiO2", TiO2);

                float Cl = rs.getFloat("Cl");
                writecontext.put("CementAnalysis_Cl", Cl);

                float Moisture = rs.getFloat("Moisture");
                writecontext.put("CementAnalysis_Moisture", Moisture);


                float LOI = rs.getFloat("LOI");
                writecontext.put("CementAnalysis_LOI", LOI);


                Timestamp datetime = rs.getTimestamp("DateEnd");


                InfluxWriteEvent writeEvent = new InfluxWriteEvent();


                writeEvent.setMeasurement(InfluxdbOperateService.MESMEASUERMENT);
                writeEvent.setTimestamp(datetime.toInstant().toEpochMilli());
                writeEvent.setData(writecontext);
//                influxdbWrite.addEvent(writeEvent);
            }
//            if(sum==0){System.out.println("查找正常，没有记录");}//这这是一个逻辑需求，如果数据库没有需要查找的内容，那么这句话怎么说都比白屏好看

        } catch (ClassNotFoundException e) {
//            logger.error("驱动问题" + e.getMessage());
        } catch (SQLException e) {
//            logger.error("发生异常:" + e.getMessage());
        } finally {
            try {
                rs.close();
                stmt.close();//这三行是关闭连接的意思，这非常重要，如果没写关闭连接
                conn.close();//程序多人打开或多人访问，就会出现卡顿，重启或奔溃
            } catch (SQLException e) {
//                logger.error(e.getMessage(), e);
            }
        }
    }
}


